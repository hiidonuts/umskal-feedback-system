<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard | UMSKAL Feedback System</title>
    <link rel="icon" type="image/x-icon" href="../img/ums_logo.png">
    <link rel="stylesheet" href="dashboard-styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="logo-container">
                <img src="../img/ums_logo.png" alt="UMSKAL Logo" class="sidebar-logo">
                <span class="sidebar-title">Admin Dashboard</span>
            </div>
        </div>

        <nav class="sidebar-nav">
            <div class="nav-section">
                <div class="nav-section-label">MENU</div>
                <a href="#overview" class="nav-item active" data-section="overview">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="12 3 20 7.5 20 16.5 12 21 4 16.5 4 7.5 12 3"></polyline>
                        <polyline points="12 12 20 7.5"></polyline>
                        <polyline points="12 12 12 21"></polyline>
                        <polyline points="12 12 4 7.5"></polyline>
                    </svg>
                    <span>Dashboard</span>
                </a>
                <a href="#faqs" class="nav-item" data-section="faqs">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M12 16v-4M12 8h.01"></path>
                    </svg>
                    <span>FAQs</span>
                </a>
                <a href="#feedback" class="nav-item" data-section="feedback">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg>
                    <span>Feedback</span>
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-section-label">GENERAL</div>
                <a href="#" class="nav-item" id="navSettings">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"></circle>
                        <path d="M12 1v6m0 6v6M4.22 4.22l4.24 4.24m2.96 2.96l4.24 4.24M1 12h6m6 0h6m-15.78 7.78l4.24-4.24m2.96-2.96l4.24-4.24"></path>
                    </svg>
                    <span>Settings</span>
                </a>
                <a href="#" class="nav-item" id="navLogout">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                        <polyline points="16 17 21 12 16 7"></polyline>
                        <line x1="21" y1="12" x2="9" y2="12"></line>
                    </svg>
                    <span>Logout</span>
                </a>
            </div>
        </nav>

        <div class="sidebar-footer">
            <button class="admin-profile-btn" id="sidebarAdminProfileBtn">
                <div class="sidebar-profile-pic">
                    <img id="sidebarAdminPic" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='50' fill='%23d0d0d0'/%3E%3Ccircle cx='50' cy='35' r='15' fill='%23a0a0a0'/%3E%3Cellipse cx='50' cy='70' rx='20' ry='18' fill='%23a0a0a0'/%3E%3C/svg%3E" alt="Admin">
                </div>
                <div class="sidebar-profile-info">
                    <div class="sidebar-profile-name" id="sidebarAdminName">Admin</div>
                    <div class="sidebar-profile-role">Administrator</div>
                </div>
            </button>
        </div>
    </aside>

    <main class="main-content">
        <div class="container">
            <section id="overview" class="dashboard-section active">
                <div class="section-header">
                    <h1>Dashboard</h1>
                    <p>Monitor feedback and system activity at a glance</p>
                </div>

                <div class="quick-stats">
                    <div class="stat-box gradient-maroon">
                        <div class="stat-number" id="totalFeedbacksCount">24</div>
                        <div class="stat-label">Total Feedbacks</div>
                        <div class="stat-change" id="feedbacksChangeText">Increased from last month</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="totalFAQsCount">12</div>
                        <div class="stat-label">Running FAQs</div>
                        <div class="stat-change">Actively used</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="pendingFeedbackCount">2</div>
                        <div class="stat-label">Pending Resolution</div>
                        <div class="stat-change pending">On Discuss</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="resolutionRateCount">85%</div>
                        <div class="stat-label">Resolution Rate</div>
                        <div class="stat-change">Last 30 days</div>
                    </div>
                </div>

                <div class="dashboard-grid-three-col">
                    <div class="chart-card">
                        <div class="card-header">
                            <h3>Feedback Analysis</h3>
                        </div>
                        <div class="chart-container">
                            <canvas id="feedbackCategoryChart" height="300"></canvas>
                        </div>
                    </div>

                    <div class="chart-card">
                        <div class="card-header">
                            <h3>FAQ Performance</h3>
                        </div>
                        <div class="chart-container">
                            <canvas id="faqPerformanceChart" height="300"></canvas>
                        </div>
                    </div>

                    <div class="chart-card">
                        <div class="card-header">
                            <h3>Average Chatbot Latency (24h)</h3>
                        </div>
                        <div class="chart-container">
                            <canvas id="chatbotLatencyChart" height="300"></canvas>
                            <div id="latencyChartPlaceholder" class="chart-placeholder" style="display: none;">
                                <div class="placeholder-content">
                                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" opacity="0.5">
                                        <polyline points="23 6 13.5 15.5 8.5 10.5 1 17"></polyline>
                                        <polyline points="17 6 23 6 23 12"></polyline>
                                    </svg>
                                    <p>Analytics will appear once chat history data is available</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="analytics-row">
                    <div class="feedback-trend-container">
                        <div class="full-width-card">
                            <div class="card-header">
                                <h3>Feedback Trend (Last 30 Days)</h3>
                            </div>
                            <div class="chart-container">
                                <canvas id="feedbackTrendChart" height="150"></canvas>
                            </div>
                        </div>
                    </div>

                    <div class="reminders-section-card">
                        <div class="reminders-header">
                            <div class="section-title">Reminders</div>
                            <button class="btn-new-reminder" id="btnNewReminder" title="Add a new reminder">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="12" y1="5" x2="12" y2="19"></line>
                                    <line x1="5" y1="12" x2="19" y2="12"></line>
                                </svg>
                                New
                            </button>
                        </div>
                        <div class="reminders-add-form" style="display: none;" id="reminderAddForm">
                            <input type="text" id="reminderInput" class="reminder-input" placeholder="Add a new reminder..." autocomplete="off">
                            <div class="reminder-form-actions">
                                <button class="btn-reminder-save" id="btnReminderSave">Add</button>
                                <button class="btn-reminder-cancel" id="btnReminderCancel">Cancel</button>
                            </div>
                        </div>
                        <div class="reminders-list" id="remindersList">
                            <div class="reminder-item">
                                <div class="reminder-header">
                                    <svg class="reminder-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                        <circle cx="12" cy="12" r="10"></circle>
                                        <path d="M12 6v6l4 2" stroke="white" stroke-width="2" fill="none"></path>
                                    </svg>
                                    <div class="reminder-time">Today 03:00 pm</div>
                                </div>
                                <div class="reminder-title">Review pending feedback</div>
                            </div>
                            <div class="reminder-item">
                                <div class="reminder-header">
                                    <svg class="reminder-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                        <circle cx="12" cy="12" r="10"></circle>
                                        <path d="M12 6v6l4 2" stroke="white" stroke-width="2" fill="none"></path>
                                    </svg>
                                    <div class="reminder-time">Due Dec 24, 2024</div>
                                </div>
                                <div class="reminder-title">Update FAQ Categories</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="faqs" class="dashboard-section">
                <div class="section-header">
                    <h1>FAQ Management</h1>
                    <p>Manage and analyze frequently asked questions</p>
                </div>

                <div class="quick-stats">
                    <div class="stat-box">
                        <div class="stat-number" id="totalViewsFAQCount">0</div>
                        <div class="stat-label">Total Views</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="totalHelpfulCount">0</div>
                        <div class="stat-label">Helpful Votes</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="totalUnhelpfulCount">0</div>
                        <div class="stat-label">Unhelpful Votes</div>
                    </div>
                </div>

                <div class="full-width-card">
                    <div class="card-header">
                        <h3>All FAQs</h3>
                        <div class="faq-filter">
                            <select id="faqCategoryFilter" class="filter-select">
                                <option value="all">All Categories</option>
                                <option value="academic">Academic</option>
                                <option value="technical">Technical</option>
                                <option value="account">Account</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                    </div>
                    <div class="faq-list" id="faqAdminList">
                        <div class="loading-state">
                            <p data-en="Loading FAQs..." data-bm="Memuatkan soalan lazim...">Loading FAQs...</p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="feedback" class="dashboard-section">
                <div class="section-header">
                    <h1>Feedback Management</h1>
                    <p>View and manage student feedback submissions</p>
                </div>

                <div class="filters-card">
                    <div class="filters-grid">
                        <div class="filter-group">
                            <select id="feedbackCategoryFilter" class="filter-select">
                                <option value="all">All Categories</option>
                                <option value="facilities">Facilities</option>
                                <option value="academics">Academics</option>
                                <option value="administration">Administration</option>
                                <option value="services">Services</option>
                                <option value="other">Other</option>
                            </select>
                        </div>

                        <div class="filter-group">
                            <select id="feedbackStatusFilter" class="filter-select">
                                <option value="all">All Status</option>
                                <option value="open">Open</option>
                                <option value="in-progress">In Progress</option>
                                <option value="resolved">Resolved</option>
                                <option value="closed">Closed</option>
                            </select>
                        </div>

                        <div class="filter-group">
                            <select id="feedbackSortFilter" class="filter-select">
                                <option value="newest">Newest First</option>
                                <option value="oldest">Oldest First</option>
                                <option value="status">By Status</option>
                            </select>
                        </div>

                        <div class="filter-group">
                            <input type="text" id="feedbackSearchInput" class="filter-input" placeholder="Search feedback...">
                        </div>

                        <div class="filter-group filter-toggle-group">
                            <label class="toggle-label">
                                <input type="checkbox" id="hideResolvedToggle" checked>
                                <span class="toggle-text">Hide Resolved</span>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="feedback-list-container">
                    <div id="feedbackAdminList" class="feedback-list">
                        <div class="loading-state">
                            <p data-en="Loading feedback..." data-bm="Memuatkan maklum balas...">Loading feedback...</p>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <div class="modal" id="feedbackDetailModal">
        <div class="modal-content glass-card">
            <button class="modal-close" id="closeFeedbackModal">&times;</button>
            <div id="feedbackDetailContent"></div>
        </div>
    </div>

    <div class="admin-profile-sidebar" id="adminProfileSidebar">
        <div class="admin-profile-sidebar-content">
            <div class="admin-profile-sidebar-header">
                <button class="admin-close-sidebar-btn" id="adminCloseSidebarBtn" aria-label="Close sidebar">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>

            <div class="admin-profile-main-section">
                <div class="admin-sidebar-profile-pic-container">
                    <img id="adminSidebarProfilePic" class="admin-sidebar-profile-pic" src="" alt="Profile Picture">
                    <button class="admin-edit-pic-btn" id="adminEditPicBtn" title="Change profile picture">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                    </button>
                    <input type="file" id="adminProfilePicInput" accept="image/*" style="display: none;">
                </div>

                <div class="admin-sidebar-display-name-container">
                    <h3 id="adminSidebarDisplayName" class="admin-sidebar-display-name"></h3>
                    <p id="adminSidebarEmail" class="admin-sidebar-email"></p>
                </div>
            </div>

            <div class="admin-profile-sections">
                <div class="admin-profile-section">
                    <button class="admin-section-toggle" data-section="profileInfo">
                        <span class="admin-section-title">Profile Information</span>
                        <svg class="admin-toggle-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </button>
                    <div class="admin-section-content" id="adminProfileInfoContent" style="display: none;">
                        <div class="admin-profile-info-grid">
                            <div class="admin-info-item">
                                <span class="admin-info-label">Email</span>
                                <p id="adminEmailValue" class="admin-info-value"></p>
                            </div>
                            <div class="admin-info-item">
                                <span class="admin-info-label">Role</span>
                                <p id="adminRoleValue" class="admin-info-value"></p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="admin-profile-section">
                    <button class="admin-section-toggle" data-section="settings">
                        <span class="admin-section-title">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="3"></circle>
                                <path d="M12 1v6m0 6v6M4.22 4.22l4.24 4.24m2.96 2.96l4.24 4.24M1 12h6m6 0h6m-15.78 7.78l4.24-4.24m2.96-2.96l4.24-4.24"></path>
                            </svg>
                            Settings
                        </span>
                        <svg class="admin-toggle-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                    </button>
                    <div class="admin-section-content" id="adminSettingsContent" style="display: none;">
                        <div class="admin-settings-list">
                            <button class="admin-setting-item" id="adminExportStatsBtn">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                    <polyline points="7 10 12 15 17 10"></polyline>
                                    <line x1="12" y1="15" x2="12" y2="3"></line>
                                </svg>
                                <span>Export Statistics</span>
                            </button>
                            <button class="admin-setting-item" id="adminSystemInfoBtn">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                                    <line x1="2" y1="20" x2="22" y2="20"></line>
                                </svg>
                                <span>System Information</span>
                            </button>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="admin-profile-sidebar-overlay" id="adminSidebarOverlay"></div>

    <div id="toastContainer" class="toast-container"></div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="dashboard.js"></script>
</body>
</html>
